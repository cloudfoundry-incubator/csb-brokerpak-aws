# Copyright 2021 VMWare Software, Inc.
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#      http:#www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
---
version: 1
name: csb-aws-sqs
id: 4b58f215-f55d-421f-8f0d-e7502794a0e8
description: AWS SQS
display_name: AWS SQS
image_url: https://www.pikpng.com/pngl/m/73-731373_aws-s3-logo-png-transparent-amazon-s3-logo.png
documentation_url: https://aws.amazon.com/sqs/
support_url: https://aws.amazon.com/sqs/
tags: [aws, SQS, preview]
plan_updateable: true
plans:
- name: standard
  id: d58c63eb-f468-4dad-98ca-e735cc5d352f
  description: 'Standard SQS Queue'
  display_name: 'Standard'
  properties:
    fifo: false
- name: fifo
  id: 88c6ab3e-8ec0-40a5-b40c-2761f66f5abc
  description: 'First in first out'
  display_name: 'FIFO'
  properties:
    fifo: true
provision:
  plan_inputs:
    - field_name: fifo
      type: boolean
      details: True if FIFO queue
  user_inputs:
    - field_name: instance_name
      type: string
      details: Name for your SQS instance
      default: csb-sqs-${request.instance_id}
      constraints:
        maxLength: 98
        minLength: 6
        pattern: ^[a-z][a-z0-9-]+(\.fifo)*$
    - field_name: region
      type: string
      details: The region of the sqs instance.
      default: us-west-2
      enum:
        us-east-2 : us-east-2
        us-east-1 : us-east-1
        us-west-1 : us-west-1
        us-west-2 : us-west-2
        ap-east-1 : ap-east-1
        ap-south-1 : ap-south-1
        ap-northeast-3 : ap-northeast-3
        ap-northeast-2 : ap-northeast-2
        ap-southeast-1 : ap-southeast-1
        ap-southeast-2 : ap-southeast-2
        ap-northeast-1 : ap-northeast-1
        ca-central-1 : ca-central-1
        cn-north-1 : cn-north-1
        cn-northwest-1 : cn-northwest-1
        eu-central-1 : eu-central-1
        eu-west-1 : eu-west-1
        eu-west-2 : eu-west-2
        eu-west-3 : eu-west-3
        eu-north-1 : eu-north-1
        me-south-1 : me-south-1
        sa-east-1 : sa-east-1
    - field_name: aws_access_key_id
      type: string
      details: AWS access key
      default: ${config("aws.access_key_id")}
    - field_name: aws_secret_access_key
      type: string
      details: AWS secret key
      default: ${config("aws.secret_access_key")}
    - field_name: delay_seconds
      type: number
      details: The time in seconds that the delivery of all messages in the queue will be delayed.
      default: 0
    - field_name: max_message_size
      type: number
      details: The limit of how many bytes a message can contain before Amazon SQS rejects it.
      default: 262144
    - field_name: message_retention_seconds
      type: number
      details: The number of seconds Amazon SQS retains a message.
      default: 345600
    - field_name: receive_wait_time_seconds
      type: number
      details: The time for which a ReceiveMessage call will wait for a message to arrive (long polling) before returning.
      default: 0
    - field_name: visibility_timeout_seconds
      type: number
      details: The visibility timeout for the queue.
      default: 30
    - field_name: redrive_policy
      details: 'The JSON hash for the policy to set up the Dead Letter Queue. E.g. { "deadLetterTargetArn": "valid-queue-arn" , "maxReceiveCount": 10 }'
      type: object
  computed_inputs:
  - name: labels
    default: ${json.marshal(request.default_labels)}
    overwrite: true
    type: object
  template_refs:
    main: terraform/sqs/provision/main.tf
    outputs: terraform/sqs/provision/outputs.tf
    provider: terraform/sqs/provision/provider.tf
    variables: terraform/sqs/provision/variables.tf
  outputs:
  - field_name: arn
    type: string
    details: ARN for the queue
  - field_name: url
    type: string
    details: URL for the queue
  - field_name: name
    type: string
    details: name for the queue
  - field_name: region
    type: string
    details: AWS region for the queue
bind:
  plan_inputs: []
  user_inputs:
  computed_inputs:
  template_refs:
  outputs:
examples:
- name: sqs-standard
  description: Standard SQS
  plan_id: d58c63eb-f468-4dad-98ca-e735cc5d352f
  provision_params: {}
  bind_params: {}
- name: sqs-standard-long-polling
  description: Standard Long Polling SQS
  plan_id: d58c63eb-f468-4dad-98ca-e735cc5d352f
  provision_params: {receive_wait_time_seconds: 20}
  bind_params: {}
- name: sqs-fifo
  description: FIFO SQS
  plan_id: 88c6ab3e-8ec0-40a5-b40c-2761f66f5abc
  provision_params: {}
  bind_params: {}
